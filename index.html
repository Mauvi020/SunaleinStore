<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sunalein Store</title>
<style>
body{margin:0;font-family:system-ui;background:#0f0f14;color:#eaeaf0}
header,footer{padding:14px}
.wrap{max-width:1200px;margin:0 auto}
header h2{margin:0}
.search{width:100%;padding:10px;border-radius:8px;border:1px solid #2a2a3a;background:#0b0b12;color:#eaeaf0;margin:10px 0}
.buttons{margin:10px 0}
.buttons button{margin:2px;padding:6px 12px;border:none;border-radius:8px;background:#7c9cff;color:#fff;cursor:pointer}
.buttons button.active{background:#ffcc66;color:#000}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px;padding:12px}
.card{background:#171722;border:1px solid #23233a;border-radius:12px;padding:10px}
.card img{width:100%;height:140px;object-fit:cover;border-radius:8px;background:#0b0b12}
.card .price{color:#ffcc66;font-weight:800}
.card .tag{color:#9aa0a6;font-size:12px}
footer{display:flex;justify-content:space-between;align-items:center;border-top:1px solid #222;padding:12px}
footer a{color:#7c9cff;text-decoration:none;font-weight:700;padding:6px 12px;border-radius:8px;background:#171722}
</style>
</head>
<body>

<header class="wrap">
<h2>Sunalein Store</h2>
<input class="search" id="search" placeholder="Suchen…">
<div class="buttons">
<button data-cat="all" class="active">Alle</button>
<button data-cat="wings">Wings</button>
<button data-cat="pets">Pets</button>
<button data-cat="hats">Hats</button>
<button data-cat="accessories">Accessories</button>
<button data-cat="effects">Effects</button>
</div>
</header>

<main class="wrap">
<section class="grid" id="grid"></section>
</main>

<footer class="wrap">
<div>Sunalein Store</div>
<a href="admin.html" target="_blank">Admin Panel</a>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

// Firebase Konfiguration
const firebaseConfig = {
  apiKey: "AIzaSyD9mfFsqwuZFX0lYHUrE3SZ7YW4YPFJMSs",
  authDomain: "sunalein-store.firebaseapp.com",
  databaseURL: "https://sunalein-store-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "sunalein-store",
  storageBucket: "sunalein-store.appspot.com",
  messagingSenderId: "919907710842",
  appId: "1:919907710842:web:c5669a0e0380c4718648c3",
  measurementId: "G-XSMVJH11W7"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const itemsRef = ref(db, "items");

let items = [];
let filter = 'all';

const grid = document.getElementById('grid');
const search = document.getElementById('search');
const buttons = document.querySelectorAll('.buttons button');

// Realtime Database laden
onValue(itemsRef, snapshot => {
  const data = snapshot.val() || {};
  // Firebase speichert als Objekt, wir wandeln in Array
  items = Object.values(data).map(i=>({
    name: i.name || "Unbekannt",
    price: i.price != null ? i.price : null,
    cat: i.cat || "all",
    img: i.img || ""
  }));
  render();
});

// Kategorie-Buttons
buttons.forEach(b=>{
  b.onclick=()=>{
    buttons.forEach(btn=>btn.classList.remove('active'));
    b.classList.add('active');
    filter=b.dataset.cat;
    render();
  }
});

// Suche
search.addEventListener('input',render);

// Render Funktion
function render(){
  grid.innerHTML='';
  if(!items || items.length===0) return;

  const list = items.filter(i=>
    (filter==='all'||i.cat.toLowerCase()===filter.toLowerCase()) &&
    i.name.toLowerCase().includes(search.value.toLowerCase())
  );

  if(list.length===0){
    grid.innerHTML='<div>Keine Items gefunden.</div>';
    return;
  }

  list.forEach(i=>{
    const c=document.createElement('div');
    c.className='card';
    c.innerHTML=`
      <img src="${i.img || 'https://via.placeholder.com/400x200?text=No+Image'}">
      <b>${i.name}</b>
      <div class="price">${i.price==null?'Preis auf Anfrage':i.price.toFixed(2).replace('.',',')+' €'}</div>
      <div class="tag">${i.cat}</div>
    `;
    grid.appendChild(c);
  });
}
</script>

</body>
</html>
