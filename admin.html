<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sunalein Admin Panel</title>
<style>
body{margin:0;font-family:system-ui;background:#0f0f14;color:#eaeaf0}
header,footer{padding:14px}
.wrap{max-width:1200px;margin:0 auto}
header h2{margin:0}
input, button{padding:8px;margin:5px;border-radius:8px;border:none}
input{width:150px;background:#0b0b12;color:#eaeaf0;border:1px solid #23233a}
button{background:#7c9cff;color:#fff;cursor:pointer}
button:hover{background:#ffcc66;color:#000}
.card{background:#171722;border:1px solid #23233a;border-radius:12px;padding:10px;margin-bottom:10px;display:flex;flex-direction:column;align-items:center;}
.card input{width:90%;margin-bottom:5px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px;padding:12px}
footer{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;border-top:1px solid #222;padding:12px}
footer a{color:#fff;text-decoration:none;font-weight:700;padding:6px 12px;border-radius:8px;background:#7c9cff}
footer a:hover{background:#ffcc66;color:#000}
</style>
</head>
<body>

<header class="wrap">
<h2>Sunalein Admin Panel</h2>
</header>

<div class="wrap" id="loginForm">
  <h3>Admin Login</h3>
  <input type="text" id="username" placeholder="Benutzername">
  <input type="password" id="password" placeholder="Passwort">
  <button onclick="checkLogin()">Login</button>
  <p id="loginError" style="color:red;"></p>
</div>

<main class="wrap" id="adminPanel" style="display:none;">
  <h3>Neues Item hinzufügen</h3>
  <input type="text" id="newName" placeholder="Name">
  <input type="text" id="newPrice" placeholder="Preis (leer = Preis auf Anfrage)">
  <input type="text" id="newCat" placeholder="Kategorie">
  <input type="text" id="newImg" placeholder="Bild URL">
  <button onclick="addItem()">Hinzufügen</button>

  <h3>Alle Items</h3>
  <section class="grid" id="itemsList"></section>
</main>

<footer class="wrap">
<div style="font-size:14px;">&copy; 2026 Sunalein Store | Alle Rechte vorbehalten</div>
<div style="display:flex;gap:10px;margin-top:5px;">
<a href="index.html" target="_blank">Store</a>
<a href="https://discord.gg/V9pPWjVSF8" target="_blank">Discord</a>
</div>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, onValue, push, update, remove } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

// Firebase Konfiguration
const firebaseConfig = {
  apiKey: "AIzaSyD9mfFsqwuZFX0lYHUrE3SZ7YW4YPFJMSs",
  authDomain: "sunalein-store.firebaseapp.com",
  databaseURL: "https://sunalein-store-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "sunalein-store",
  storageBucket: "sunalein-store.appspot.com",
  messagingSenderId: "919907710842",
  appId: "1:919907710842:web:c5669a0e0380c4718648c3",
  measurementId: "G-XSMVJH11W7"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const itemsRef = ref(db, "items");

// Login Funktion
function checkLogin(){
  const user = document.getElementById("username").value.toLowerCase();
  const pass = document.getElementById("password").value;
  const error = document.getElementById("loginError");

  if(user === "sunalein" && pass === "Labyrinth876/12"){
    document.getElementById("loginForm").style.display = "none";
    document.getElementById("adminPanel").style.display = "block";
    loadItems();
  } else {
    error.textContent = "Falscher Benutzername oder Passwort!";
  }
}

// Items laden
function loadItems(){
  onValue(itemsRef, snapshot => {
    const data = snapshot.val() || {};
    const itemsArray = Object.entries(data); // [key, value]
    const container = document.getElementById("itemsList");
    container.innerHTML = "";
    itemsArray.forEach(([key, item])=>{
      const div = document.createElement("div");
      div.className="card";
      div.innerHTML=`
        <input type="text" value="${item.name}" class="name">
        <input type="text" value="${item.price != null ? item.price : ''}" class="price">
        <input type="text" value="${item.cat}" class="cat">
        <input type="text" value="${item.img || ''}" class="img">
        <div style="display:flex;gap:5px;">
          <button onclick="updateItem('${key}', this)">Speichern</button>
          <button onclick="deleteItem('${key}')">Löschen</button>
        </div>
      `;
      container.appendChild(div);
    });
  });
}

// Item bearbeiten
window.updateItem = function(key, btn){
  const div = btn.closest(".card");
  const name = div.querySelector(".name").value;
  const price = div.querySelector(".price").value;
  const cat = div.querySelector(".cat").value;
  const img = div.querySelector(".img").value;
  update(ref(db,"items/"+key),{
    name:name,
    price: price === "" ? null : parseFloat(price),
    cat: cat,
    img: img
  });
}

// Item löschen
window.deleteItem = function(key){
  if(confirm("Item wirklich löschen?")) remove(ref(db,"items/"+key));
}

// Neues Item hinzufügen
window.addItem = function(){
  const name = document.getElementById("newName").value;
  const price = document.getElementById("newPrice").value;
  const cat = document.getElementById("newCat").value;
  const img = document.getElementById("newImg").value;
  if(!name || !cat){ alert("Name und Kategorie müssen ausgefüllt sein!"); return; }
  push(itemsRef,{
    name:name,
    price: price === "" ? null : parseFloat(price),
    cat:cat,
    img: img || ""
  });
  document.getElementById("newName").value="";
  document.getElementById("newPrice").value="";
  document.getElementById("newCat").value="";
  document.getElementById("newImg").value="";
}
</script>

</body>
</html>
