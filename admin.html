<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Sunalein Admin Panel</title>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, onValue, push, update, remove } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyD9mfFsqwuZFX0lYHUrE3SZ7YW4YPFJMSs",
  authDomain: "sunalein-store.firebaseapp.com",
  databaseURL: "https://sunalein-store-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "sunalein-store",
  storageBucket: "sunalein-store.appspot.com",
  messagingSenderId: "919907710842",
  appId: "1:919907710842:web:c5669a0e0380c4718648c3",
  measurementId: "G-XSMVJH11W7"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const itemsRef = ref(db, "items");

// Admin Login Formular
function checkLogin() {
  const user = document.getElementById("username").value.toLowerCase();
  const pass = document.getElementById("password").value;
  if(user === "sunalein" && pass === "Labyrinth876/12") {
    document.getElementById("loginForm").style.display="none";
    document.getElementById("adminPanel").style.display="block";
    loadItems();
  } else alert("Falscher Benutzername oder Passwort!");
}

function loadItems() {
  onValue(itemsRef, snapshot => {
    const data = snapshot.val() || {};
    const container = document.getElementById("itemsList");
    container.innerHTML = "";
    for(let key in data) {
      const item = data[key];
      const div = document.createElement("div");
      div.className="adminItem";
      div.innerHTML=`
        <input type="text" value="${item.name}" class="name">
        <input type="text" value="${item.price !== null ? item.price : ''}" class="price" placeholder="Preis auf Anfrage">
        <input type="text" value="${item.cat}" class="cat" placeholder="Kategorie">
        <button onclick="updateItem('${key}', this)">Speichern</button>
        <button onclick="deleteItem('${key}')">Löschen</button>
      `;
      container.appendChild(div);
    }
  });
}

window.updateItem = function(key, btn) {
  const div = btn.parentElement;
  const name = div.querySelector(".name").value;
  const price = div.querySelector(".price").value;
  const cat = div.querySelector(".cat").value;
  update(ref(db, "items/" + key), {
    name: name,
    price: price === "" ? null : parseFloat(price),
    cat: cat
  });
}

window.deleteItem = function(key) {
  if(confirm("Item wirklich löschen?")) remove(ref(db, "items/" + key));
}

window.addItem = function() {
  const name = document.getElementById("newName").value;
  const price = document.getElementById("newPrice").value;
  const cat = document.getElementById("newCat").value;
  if(!name || !cat) { alert("Name und Kategorie müssen ausgefüllt sein!"); return; }
  push(itemsRef, {
    name: name,
    price: price === "" ? null : parseFloat(price),
    cat: cat,
    img: ""
  });
  document.getElementById("newName").value="";
  document.getElementById("newPrice").value="";
  document.getElementById("newCat").value="";
}
</script>
<style>
body { font-family: Arial, sans-serif; margin:0; background:#f0f0f0; }
header { background:#4B0082; color:white; padding:20px; text-align:center; }
h1 { margin:0; }
#loginForm, #adminPanel { padding:20px; }
#adminPanel { display:none; }
.adminItem { margin-bottom:10px; background:white; padding:10px; border-radius:8px; display:flex; gap:5px; align-items:center; }
.adminItem input { width:120px; padding:5px; }
button { padding:5px 8px; }
footer { text-align:center; padding:15px; background:#222; color:white; position:fixed; width:100%; bottom:0; }
a { color:#FFD700; text-decoration:none; }
a:hover { text-decoration:underline; }
</style>
</head>
<body>
<header>
  <h1>Admin Panel - Sunalein Store</h1>
</header>

<div id="loginForm">
  <input type="text" id="username" placeholder="Benutzername">
  <input type="password" id="password" placeholder="Passwort">
  <button onclick="checkLogin()">Login</button>
</div>

<div id="adminPanel">
  <h2>Neues Item hinzufügen</h2>
  <input type="text" id="newName" placeholder="Name">
  <input type="text" id="newPrice" placeholder="Preis (leer = Preis auf Anfrage)">
  <input type="text" id="newCat" placeholder="Kategorie">
  <button onclick="addItem()">Hinzufügen</button>

  <h2>Alle Items</h2>
  <div id="itemsList"></div>
</div>

<footer>
  Sunalein Store &copy; 2026 | <a href="https://discord.gg/V9pPWjVSF8" target="_blank">Discord Server</a>
</footer>
</body>
</html>
